<!--pages/match-detail/match-detail.wxml - 比赛详情-->
<view class="container" wx:if="{{match}}">
  <view class="card match-info">
    <view class="match-name">{{match.name}}</view>
    <view class="match-meta">
      <text class="status-tag status-{{match.status}}">{{match.status === 'registering' ? '报名中' : match.status === 'teaming' ? '组队中' : match.status === 'playing' ? '进行中' : '已结束'}}</text>
      <text class="mode-tag">{{match.type === 'singles' ? '单打' : '双打'}} - {{match.subMode === 'single-turn' ? '单打转' : match.subMode === 'team-turn' ? '小队转' : '晋级赛'}}</text>
    </view>
    <view class="match-stats">
      <text>报名人数：{{match.players ? match.players.length : 0}} / {{match.maxPlayers}}</text>
    </view>
    <view class="match-extras" wx:if="{{match.location || match.time}}">
      <text wx:if="{{match.time}}">时间：{{match.time}}</text>
      <text wx:if="{{match.location}}">地点：{{match.location}}</text>
    </view>
  </view>

  <view class="card">
    <view class="section-title">报名列表</view>
    <view class="player-list" wx:if="{{playerList.length > 0}}">
      <view class="player-item" wx:for="{{playerList}}" wx:key="_id">
        <image class="avatar" src="{{item.avatarUrl}}" mode="aspectFill" wx:if="{{item.avatarUrl}}"></image>
        <view class="avatar avatar-placeholder" wx:else></view>
        <text>{{item.nickName || '未知'}}</text>
      </view>
    </view>
    <view class="empty-tip" wx:else>暂无报名</view>
  </view>

  <view class="actions">
    <button
      wx:if="{{!hasJoined && match.status === 'registering'}}"
      class="btn-primary"
      bindtap="onJoinTap"
    >立即报名</button>

    <button
      wx:if="{{isCreator && match.status === 'registering' && match.players && match.players.length >= match.minPlayers}}"
      class="btn-primary"
      bindtap="onStartTeamTap"
    >开始组队</button>
  </view>

  <view class="card" wx:if="{{match.teams && (match.status === 'teaming' || match.status === 'playing' || match.status === 'finished')}}">
    <view class="section-title">组队结果</view>
    <view class="teams-display">
      <text>组队已完成，详见云端资料</text>
    </view>
  </view>
</view>
